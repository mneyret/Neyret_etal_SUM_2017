All_es2016 = All_es[All_es$Year == '2016', c(5:28, 30)]
All_es2016$Wo = as.numeric(as.character(All_es2016$Wo))
All_es2016$CH = as.numeric(as.character(All_es2016$CH))
All_es2016$WH = as.numeric(as.character(All_es2016$WH))
All_es2016_agg = aggregate(All_es2016[,c(3,4,6:10,12, 14, 16:20,22:25) ], list(All_es2016$Microplot), mean  )
Mat = corstarsl(as.matrix(All_es2016_agg[,-1]))
xtable(Mat)
colnames(All_es2016)
All_es2016_agg = aggregate(All_es2016[,c('coef.ruiss.median',"total_sed_loss", "Coef.ruiss.moyen","Fag","FG","ST", "ERO",
"G","Charcoals","Residues", "Wo" , "Term", "Mosses","CC","WC","CH",               "WH"                "Ped."
"Pedhx", "Pedmean" ) ], list(All_es2016$Microplot), mean  )
All_es2016_agg = aggregate(All_es2016[,c('coef.ruiss.median',"total_sed_loss", "Coef.ruiss.moyen","Fag","FG","ST", "ERO",
"G","Charcoals","Residues", "Wo" ,  "Mosses","CC","WC","CH",               "WH" ,               "Ped."
"Pedhx","Pedmean") ], list(All_es2016$Microplot), mean  )
All_es2016_agg =
aggregate(All_es2016[,c('coef.ruiss.median',"total_sed_loss", "Coef.ruiss.moyen","Fag","FG","ST",
"ERO","G","Charcoals","Residues", "Wo" ,  "Mosses","CC","WC","CH","Pedhx",
"Pedmean") ], list(All_es2016$Microplot), mean  )
Mat = corstarsl(as.matrix(All_es2016_agg[,-1]))
xtable(Mat)
All_es2016_agg =
aggregate(All_es2016[,c('coef.ruiss.median',"total_sed_loss","Fag","FG","ST",
"ERO","G","Charcoals","Residues", "Wo" ,  "Mosses","CC","WC","CH","Pedhx",
"Pedmean") ], list(All_es2016$Microplot), mean  )
Mat = corstarsl(as.matrix(All_es2016_agg[,-1]))
xtable(Mat)
All_es2015_agg = aggregate(All_es2015[,c('coef.ruiss.median',"total_sed_loss","Fag","FG","ST",
"ERO","G","Charcoals","Residues", "Wo" ,  "Mosses","CC","WC","CH","Pedhx",
"Pedmean")], list(All_es2015$Microplot), mean  )
Mat = corstarsl(as.matrix(All_es2015_agg[,-1]))
xtable(Mat)
All_es2015 = All_es[All_es$Year == '2015', c(5:28, 30)]
All_es2015$Wo = as.numeric(as.character(All_es2015$Wo))
All_es2015$CH = as.numeric(as.character(All_es2015$CH))
All_es2015$WH = as.numeric(as.character(All_es2015$WH))
All_es2015_agg = aggregate(All_es2015[,c('coef.ruiss.median',"total_sed_loss","Fag","FG","ST",
"ERO","G","Charcoals","Residues", "Wo" ,  "Mosses","CC","WC","CH","Pedhx",
"Pedmean")], list(All_es2015$Microplot), mean  )
Mat = corstarsl(as.matrix(All_es2015_agg[,-1]))
xtable(Mat)
All_es2015_agg = aggregate(All_es2015[,c('coef.ruiss.median',"Fag","FG","ST",
"ERO","G","Charcoals","Residues", "Wo" ,  "Mosses","CC","WC","CH","Pedhx",
"Pedmean")], list(All_es2015$Microplot), mean  )
Mat = corstarsl(as.matrix(All_es2015_agg[,-1]))
xtable(Mat)
All_es2015_agg = aggregate(All_es2015[,c('coef.ruiss.median',"Fag","FG","ST",
"ERO","G","Residues", "Wo" ,  "Mosses","CC","WC","CH","Pedhx",
"Pedmean")], list(All_es2015$Microplot), mean  )
Mat = corstarsl(as.matrix(All_es2015_agg[,-1]))
xtable(Mat)
All_es2016_diff =  (All_es[All_es$Year == '2016' & All_es$Month == "Aout",c('coef.ruiss.median',"total_sed_loss","Fag","FG","ST",
"ERO","G","Charcoals","Residues", "Wo" ,  "Mosses","CC","WC","CH","Pedhx",
"Pedmean") ] -
All_es[All_es$Year == '2016' & All_es$Month == "May", c('coef.ruiss.median',"total_sed_loss","Fag","FG","ST",
"ERO","G","Charcoals","Residues", "Wo" ,  "Mosses","CC","WC","CH","Pedhx",
"Pedmean")]) / All_es[All_es$Year == '2016' & All_es$Month == "May", c('coef.ruiss.median',"total_sed_loss","Fag","FG","ST",
"ERO","G","Charcoals","Residues", "Wo" ,  "Mosses","CC","WC","CH","Pedhx",
"Pedmean") ]
Melt_2016
tapply(Melt_2016$Cumul.since.last.event, Melt_2016$Microplot, sum)
tapply(Melt_2016$Cumul.since.last.event, Melt_2016$Microplot, sum, na.rm = T)
Melt_2016
All_es <- read.csv("~/Desktop/Projet_M2/Data/Raw_data/Microplot_erosion/All_état_surface.csv", sep='\t')
All_es2016_agg =
aggregate(All_es2016[,c('coef.ruiss.median',"total_sed_loss","Fag","FG","ST",
"ERO","G","Charcoals","Residues", "Wo" ,  "Mosses","CC","WC","CH","Pedhx",
"Pedmean") ], list(All_es2016$Microplot), mean  )
All_es <- read.csv("~/Desktop/Projet_M2/Data/Raw_data/Microplot_erosion/All_état_surface.csv", sep='\t')
All_es2015 = All_es[All_es$Year == '2015', c(5:28, 30)]
All_es2015$Wo = as.numeric(as.character(All_es2015$Wo))
All_es2015$CH = as.numeric(as.character(All_es2015$CH))
All_es2015$WH = as.numeric(as.character(All_es2015$WH))
All_es2016 = All_es[All_es$Year == '2016', c(5:28, 30)]
All_es2016$Wo = as.numeric(as.character(All_es2016$Wo))
All_es2016$CH = as.numeric(as.character(All_es2016$CH))
All_es2016$WH = as.numeric(as.character(All_es2016$WH))
All_es2016_agg =
aggregate(All_es2016[,c('coef.ruiss.median','yearly_coeff',"total_sed_loss","Fag","FG","ST",
"ERO","G","Charcoals","Residues", "Wo" ,  "Mosses","CC","WC","CH","Pedhx",
"Pedmean") ], list(All_es2016$Microplot), mean  )
for (i in c('yearly_coeff',"Fag","FG","ST",
"ERO","G","Charcoals","Residues", "Wo" ,  "Mosses","CC","WC","CH","Pedhx",
"Pedmean")){
print('----------------------------------------------------------------------')
print(i)
D = data.frame('V' = All_es2016_agg[,i], 'Co' = log(All_es2016_agg$yearly_coeff),
'LU'  = rep(c('M', 'ORI', 'ORS', 'YR'), each = 3))
#mod_crop = lm(V~LU, data = D)
#print(summary(glht(mod_crop)))
#print(cld(glht(mod_crop, linfct = mcp(LU = 'Tukey'))))
mod0 = lm(Co~LU, data = D)
mod = lm(residuals(mod0) ~ V, data = D)
print(anova(mod))
}
for (i in c('yearly_coeff',"Fag","FG","ST",
"ERO","G","Charcoals","Residues", "Wo" ,  "Mosses","CC","WC","CH","Pedhx",
"Pedmean")){
print('----------------------------------------------------------------------')
print(i)
D = data.frame('V' = All_es2016_agg[,i], 'Co' = log(All_es2016_agg$yearly_coeff),
'LU'  = rep(c('M', 'ORI', 'ORS', 'YR'), each = 3))
#mod_crop = lm(V~LU, data = D)
#print(summary(glht(mod_crop)))
#print(cld(glht(mod_crop, linfct = mcp(LU = 'Tukey'))))
mod0 = lm(Co~LU, data = D)
mod = lm(Co ~ V, data = D)
print(anova(mod))
}
for (i in c("Fag","FG","ST",
"ERO","G","Charcoals","Residues", "Wo" ,  "Mosses","CC","WC","CH","Pedhx",
"Pedmean")){
print('----------------------------------------------------------------------')
print(i)
D = data.frame('V' = All_es2016_agg[,i], 'Co' = log(All_es2016_agg$yearly_coeff),
'LU'  = rep(c('M', 'ORI', 'ORS', 'YR'), each = 3))
#mod_crop = lm(V~LU, data = D)
#print(summary(glht(mod_crop)))
#print(cld(glht(mod_crop, linfct = mcp(LU = 'Tukey'))))
mod0 = lm(Co~LU, data = D)
mod = lm(Co ~ V, data = D)
print(summary(mod))
}
plot(mod)
for (i in c("Fag","FG","ST",
"ERO","G","Charcoals","Residues", "Wo" ,  "Mosses","CC","WC","CH","Pedhx",
"Pedmean")){
print('----------------------------------------------------------------------')
print(i)
D = data.frame('V' = All_es2016_agg[,i], 'Co' = log(All_es2016_agg$yearly_coeff),
'LU'  = rep(c('M', 'ORI', 'ORS', 'YR'), each = 3))
#mod_crop = lm(V~LU, data = D)
#print(summary(glht(mod_crop)))
#print(cld(glht(mod_crop, linfct = mcp(LU = 'Tukey'))))
mod0 = lm(Co~LU, data = D)
mod = lm(Co ~ V + LU, data = D)
print(Anova(mod, type = 3))
}
for (i in c("Fag","FG","ST",
"ERO","G","Charcoals","Residues", "Wo" ,  "Mosses","CC","WC","CH","Pedhx",
"Pedmean")){
print('----------------------------------------------------------------------')
print(i)
D = data.frame('V' = All_es2016_agg[,i], 'Co' = log(All_es2016_agg$yearly_coeff),
'LU'  = rep(c('M', 'ORI', 'ORS', 'YR'), each = 3))
#mod_crop = lm(V~LU, data = D)
#print(summary(glht(mod_crop)))
#print(cld(glht(mod_crop, linfct = mcp(LU = 'Tukey'))))
mod0 = lm(Co~LU, data = D)
mod = lm(Co ~ V + LU, data = D)
print(summary(mod))
}
ggplot(All_es2016_agg, aes(x = ST, y = yearly_coeff)) + geom_point()
ggplot(All_es2015_agg, aes(x = ST, y = yearly_coeff)) + geom_point()
All_es2015_agg = aggregate(All_es2015[,c('coef.ruiss.median',"yearly_coeff","Fag","FG","ST",
"ERO","G","Residues", "Wo" ,  "Mosses","CC","WC","CH","Pedhx",
"Pedmean")], list(All_es2015$Microplot), mean  )
ggplot(All_es2016_agg, aes(x = ST, y = yearly_coeff)) + geom_point()
ggplot(All_es2015_agg, aes(x = ST, y = yearly_coeff)) + geom_point()
ggplot(All_es2016_agg, aes(x = ST, y = yearly_coeff, color = Crop)) + geom_point()
All_es2015_agg[,1]
All_es2015 = All_es[All_es$Year == '2015', c(5:28, 30)]
All_es2015$Wo = as.numeric(as.character(All_es2015$Wo))
All_es2015$CH = as.numeric(as.character(All_es2015$CH))
All_es2015$WH = as.numeric(as.character(All_es2015$WH))
All_es <- read.csv("~/Desktop/Projet_M2/Data/Raw_data/Microplot_erosion/All_état_surface.csv", sep='\t')
tapply(Melt_2015[Melt_2015$Coeff>0 & Melt_2015$Coeff<1.5,]$Coeff, Melt_2015[Melt_2015$Coeff>0 & Melt_2015$Coeff<1.5,]$Microplot, mean, na.rm = T)
tapply(Melt_2016[Melt_2016$Coeff>0 & Melt_2016$Coeff<1.5,]$Coeff, Melt_2016[Melt_2016$Coeff>0 & Melt_2016$Coeff<1.5,]$Microplot, median, na.rm = T)
All_es2015_agg = aggregate(All_es2015[,c('coef.ruiss.median',"yearly_coeff","Fag","FG","ST",
"ERO","G","Residues", "Wo" ,  "Mosses","CC","WC","CH","Pedhx",
"Pedmean")], list(All_es2015$Microplot), mean  )
All_es2015_agg[,1]
All_es <- read.csv("~/Desktop/Projet_M2/Data/Raw_data/Microplot_erosion/All_état_surface.csv", sep='\t')
All_es2015 = All_es[All_es$Year == '2015', c(5:28, 30)]
All_es2015$Wo = as.numeric(as.character(All_es2015$Wo))
All_es2015$CH = as.numeric(as.character(All_es2015$CH))
All_es2015$WH = as.numeric(as.character(All_es2015$WH))
All_es2015_agg = aggregate(All_es2015[,c('coef.ruiss.median',"yearly_coeff","Fag","FG","ST",
"ERO","G","Residues", "Wo" ,  "Mosses","CC","WC","CH","Pedhx",
"Pedmean")], list(All_es2015$Microplot), mean  )
All_es2015_agg[,1]
All_es2016_agg$Crop = gsub('[1-3],','', All_es2015_agg[,1])
All_es2015_agg$Crop = gsub('[1-3],','', All_es2015_agg[,1])
All_es2016_agg$Crop = gsub('[1-3],','', All_es2016_agg[,1])
ggplot(All_es2016_agg, aes(x = ST, y = yearly_coeff,color = Crop)) + geom_point()
gsub('[1-3],','', All_es2016_agg[,1])
All_es2016_agg$Crop = gsub('[1-3]','', All_es2016_agg[,1])
All_es2015_agg$Crop = gsub('[1-3]','', All_es2015_agg[,1])
ggplot(All_es2016_agg, aes(x = ST, y = yearly_coeff,color = Crop)) + geom_point()
ggplot(All_es2016_agg, aes(x = ST, y = yearly_coeff,color = Crop)) + geom_point() + xlab('% Structural crust') + ylab('Yearly runoff coeff (%)')
ggplot(All_es2015_agg, aes(x = ST, y = yearly_coeff,color = Crop)) + geom_point()+ xlab('% Structural crust') + ylab('Yearly runoff coeff (%)')
ggplot(All_es2016_agg, aes(x = ST, y = yearly_coeff,color = Crop)) + geom_point() + xlab('% Structural crust') + ylab('Yearly runoff coeff (%)') + theme_bw()
ggplot(All_es2015_agg, aes(x = ST, y = yearly_coeff,color = Crop)) + geom_point()+ xlab('% Structural crust') + ylab('Yearly runoff coeff (%)')+ theme_bw()
ggplot(All_es2016_agg, aes(x = Residues, y = yearly_coeff,color = Crop)) + geom_point() + xlab('% Structural crust') + ylab('Yearly runoff coeff (%)') + theme_bw()
ggplot(All_es2015_agg, aes(x = Residues, y = yearly_coeff,color = Crop)) + geom_point()+ xlab('% Structural crust') + ylab('Yearly runoff coeff (%)')+ theme_bw()
ggplot(All_es2016_agg, aes(x = Wo, y = yearly_coeff,color = Crop)) + geom_point() + xlab('% Residues') + ylab('Yearly runoff coeff (%)') + theme_bw()
ggplot(All_es2015_agg, aes(x = Wo, y = yearly_coeff,color = Crop)) + geom_point()+ xlab('% Residues') + ylab('Yearly runoff coeff (%)')+ theme_bw()
library(readr)
library(ggplot2)
library(lubridate)
library(nlme)
library(lsmeans)
library(data.table)
library(dplyr)
library(tidyr)
library(plyr)
library(reshape2)
Data_2015<- read.csv("~/Desktop/Projet_M2/Data/Analysis/Data/Erosion microplots/2015 Meteo_HuayLang_rain.csv", sep = '\t')
Data_2016<- read.csv("~/Desktop/Projet_M2/Data/Analysis/Data/Erosion microplots/2016 Meteo_HuayLang_rain.csv", sep = '\t')
Data_2015 = Data_2015[is.na(Data_2015$Date) == FALSE,]
Data_2016 = Data_2016[is.na(Data_2016$Date)==FALSE,]
Meteo_2015 = Data_2015[,c("X", "Date", "API_eventstart" ,"Cumul.since.last.event", "max.EI30.since.last.event", "Sum.EC.since.last.event")]
Rain_2015 = Data_2015[Data_2015$Ruiss.tot >0 & Data_2015$Cumul.1 == 0,]
Ruiss_2015 = melt(Rain_2015[ , c('X', "RuissM11","RuissM12" ,"RuissM13","RuissYRU1","RuissYRU2","RuissYRU3",
"RuissOR2S1","RuissOR2S2","RuissOR2S3",  "RuissOR2I1" , "RuissOR2I2","RuissOR2I3")]
, id.var = 'X', value.name = 'Runoff', variable.name = 'Microplot')
Ruiss_2015$Microplot = gsub('Ruiss', '', Ruiss_2015$Microplot)
Coef_2015 = melt(Rain_2015[, c('X', "Coef.ruissM11" ,"Coef.ruissM12","Coef.ruissM13","Coef.ruissYRU1", "Coef.ruissYRU2","Coef.ruissYRU3",
"Coef.ruissOR2S1","Coef.ruissOR2S2" ,"Coef.ruissOR2S3" ,"Coef.ruissOR2I1","Coef.ruissOR2I2", "Coef.ruissOR2I3")]
, id.var = 'X', value.name = 'Coeff', variable.name = 'Microplot')
Coef_2015$Microplot = gsub('Coef.ruiss', '', Coef_2015$Microplot)
Meteo_2015$Month = Meteo_2015$Date  %>%
as.Date(origin = "1900-01-01")  %>%
format(format = '%y%m')
Meteo_2015$Day = Meteo_2015$Date  %>%
as.Date(origin = "1900-01-01")
Melt_2015 = Reduce(function(...) merge(..., all=TRUE), list(Meteo_2015,Ruiss_2015,Coef_2015))#, Sediments_2016,P_2016,K_2016))
Meteo_2016 = Data_2016[,c("X.", "Date", "API_eventstart" ,"Cumul.since.last.event", "max.EI30.since.last.event", "Sum.EC.since.last.event")]
Rain_2016 = Data_2016[Data_2016$Ruiss.tot >0 & Data_2016$Coeff.1 == 0,]
Ruiss_2016 = melt(Rain_2016[, c('X.', "Ruiss.OR4I1","Ruiss.OR4I2" ,"Ruiss.OR4I3","Ruiss.OR4S1","Ruiss.OR4S2","Ruiss.OR4S3",
"Ruiss.YRM1","Ruiss.YRM2","Ruiss.YRM3",  "Ruiss.M1" , "Ruiss.M2","Ruiss.M3")]
, id.var = 'X.', value.name = 'Runoff', variable.name = 'Microplot')
Ruiss_2016$Microplot = gsub('Ruiss.', '', Ruiss_2016$Microplot)
Sediments_2016 = melt(Rain_2016[, c('X.', "M1sediment","M2sediment","M3sediment", "YRM1sediment","YRM2sediment","YRM3sediment",
"OR4S1sediment","OR4S2sediment","OR4S3sediment", "OR4I1sediment", "OR4I2sediment", "OR4I3sediment")]
, id.var = 'X.', value.name = 'Sediment', variable.name = 'Microplot')
Sediments_2016$Microplot = gsub('sediment', '', Sediments_2016$Microplot)
Coef_2016 = melt(Rain_2016[, c('X.', "Coef.ruiss.OR4I1" ,"Coef.ruiss.OR4I2","Coef.ruiss.OR4I3","Coef.ruiss.OR4S1", "Coef.ruiss.OR4S2","Coef.ruiss.OR4S3",
"Coef.ruiss.YRM1","Coef.ruiss.YRM2" ,"Coef.ruiss.YRM3" ,"Coef.ruiss.M1","Coef.ruiss.M2", "Coef.ruiss.M3")]
, id.var = 'X.', value.name = 'Coeff', variable.name = 'Microplot')
Coef_2016$Microplot = gsub('Coef.ruiss.', '', Coef_2016$Microplot)
K_2016 = melt(Rain_2016[, c('X.', "M1K","M2K","M3K", "YRM1K","YRM2K","YRM3K",
"OR4S1K","OR4S2K","OR4S3K", "OR4I1K", "OR4I2K", "OR4I3K")]
, id.var = 'X.', value.name = 'K', variable.name = 'Microplot')
K_2016$Microplot = gsub('K', '', K_2016$Microplot)
P_2016 = melt(Rain_2016[, c('X.', "M1P","M2P","M3P", "YRM1P","YRM2P","YRM3P",
"OR4S1P","OR4S2P","OR4S3P", "OR4I1P", "OR4I2P", "OR4I3P")]
, id.var = 'X.', value.name = 'P', variable.name = 'Microplot')
P_2016$Microplot = gsub('P', '', P_2016$Microplot)
Meteo_2016$Month = Meteo_2016$Date  %>%
as.Date(origin = "1900-01-01")  %>%
format(format = '%y%m')
Meteo_2016$Day = Meteo_2016$Date  %>%
as.Date(origin = "1900-01-01")
Ruiss_2016
Ruiss_2016
Sediments_2016
Coef_2016
K_2016
P_2016
Meteo_2016
list(Meteo_2016,Ruiss_2016,Coef_2016, Sediments_2016,P_2016,K_2016)
Melt_2016 = Reduce(function(...) merge(..., all=TRUE), list(Meteo_2016,Ruiss_2016,Coef_2016, Sediments_2016,P_2016,K_2016))
colnames(Melt_2015)[1] = 'X.'
Melt_2015$Yr = rep('2015')
Melt_2016$Yr = rep('2016')
Melt_2015$X. = as.character(Melt_2015$X.)
Melt_2016$X. = as.character(Melt_2016$X.)
Melt_tot = rbind(Melt_2015, Melt_2016[,c(1:11, 15)])
Melt_tot$Crop = gsub('[1-9]', '', Melt_tot$Microplot)
ggplot(Melt_tot, aes(y=Coeff, x=Day, group = Microplot, color = Microplot)) +
geom_line() + theme_bw() + xlab('Date') + ylab('Runoff coef') + scale_x_date(date_breaks = "1 month", date_labels = "%b")
ggplot(Melt_tot, aes(y=Coeff, x=Day, group = Microplot, color = Microplot)) +
geom_line() + theme_bw() + xlab('Date') + ylab('Runoff coef') + scale_x_date(date_breaks = "1 month", date_labels = "%b")
ggplot(Melt_tot, aes(y=Coeff, x=Day, group = Microplot, color = Microplot)) +
geom_line() + theme_bw() + xlab('Date') + ylab('Runoff coef') + scale_x_date(date_breaks = "1 month", date_labels = "%b")
tapply(Melt_tot[Melt_tot$Coeff < 1,]$Coeff, Melt_tot[Melt_tot$Coeff < 1,]$Crop, mean, na.rm = T)
ggplot(Melt_tot, aes(y=Coeff, x=Day, group = Microplot, color = Crop)) +
geom_line() + theme_bw() + xlab('Date') + ylab('Runoff coef') + scale_x_date(date_breaks = "1 month", date_labels = "%b")
summary(lme(Coeff ~ Crop, random = ~1|Microplot, data = Melt_tot, na.action = na.omit))
mod_runoff_tot =lme(log(Runoff) ~
API_eventstart*Crop+ max.EI30.since.last.event*Crop +
Date*Crop+Cumul.since.last.event*Crop
, random =
~1|Microplot,
data = Melt_tot, method = 'ML')
meteo = read.table('monthly_meteo2015-2016.csv', sep = '\t', head = TRUE)
meteo$month = 1:22
meteo$Season = c('Dry season', rep('Rainy season', 8), rep('Dry season',4), rep('sainy Season',8), 'Dry season')
rf = ggplot(meteo, aes(y = Rainfall, x = month))  + theme_bw()+
#  color = c(rep('black', 12), 'red', rep('black', 9)))+
labs(x = "", y = 'Rainfall (mm)') +
#scale_fill_manual(labels = c('Dry season', 'Rainy season'), values = c('gray50', 'gray10'))+
# color = c(rep('black', 12), 'red', rep('black', 9)))+
scale_x_continuous(breaks = meteo$month[seq(1,22, 2)] , labels = meteo$X[seq(1,22, 2)]) +
annotate("rect", xmin = 2, xmax = 9, ymin = -5, ymax = 420,  alpha = .8,fill = 'gray90') +
annotate("rect", xmin = 14, xmax = 21, ymin = -5, ymax = 420,  alpha = .8,fill = 'gray90') +
geom_vline(aes(xintercept=meteo$month),linetype="dotted",
size = c(rep(0.3, 12), 1, rep(0.3, 9)))+
geom_bar(stat="identity") +
annotate("rect", xmin = 4, xmax = 8, ymin = -35, ymax = -5, alpha = 1,fill = 'white') +
annotate("rect", xmin = 16, xmax = 20, ymin = -35, ymax = -5, alpha = 1,fill = 'white') +
annotate("text", x = c(6,18),y = c(-25, -25),  label = c('2015', '2016'))
rh = ggplot(meteo, aes(y = RH, x = month)) +
annotate("rect", xmin = 2, xmax = 9, ymin = 25, ymax = 100,  alpha = .8, fill = 'gray90') +
annotate("rect", xmin = 14, xmax = 21, ymin = 25, ymax = 100,  alpha = .8,fill = 'gray90') +
geom_line() +
geom_vline(aes(xintercept=meteo$month),linetype="dotted",
size = c(rep(0.3, 12), 1, rep(0.3, 9))) +
scale_x_continuous(breaks = meteo$month[seq(1,22, 2)] , labels = meteo$X[seq(1,22, 2)])  +
labs(x = "", y = 'Relative air humidity (%)') + theme_bw()
rh
rdens = ggplot(meteo, aes(y = Rdens, x = month))  +
annotate("rect", xmin = 2, xmax = 9, ymin = 0, ymax = 0.4,  alpha = .8,fill = 'gray90') +
annotate("rect", xmin = 14, xmax = 21, ymin = 0, ymax = 0.4, alpha = .8,fill = 'gray90') +
geom_vline(aes(xintercept=meteo$month),linetype="dotted",
size = c(rep(0.3, 12), 1, rep(0.3, 9)))+
scale_x_continuous(breaks = meteo$month[seq(1,22, 2)] , labels = meteo$X[seq(1,22, 2)])  +
labs(x = "", y = 'Rainfall erosivity') + theme_bw() +
geom_bar(stat="identity")
library(ggplot2)
library(grid)
library(gridExtra)
#pdf('/Users/Margot/Desktop/Projet_M2/Documents/Papers/Figures/meteo.pdf', width = 9, height = )
grid.arrange(rf, rh,rdens, ncol = 1)
#dev.off()
rf = ggplot(meteo, aes(y = Rainfall, x = month))  + theme_bw()+
#  color = c(rep('black', 12), 'red', rep('black', 9)))+
labs(x = "", y = 'Rainfall (mm)') +
#scale_fill_manual(labels = c('Dry season', 'Rainy season'), values = c('gray50', 'gray10'))+
# color = c(rep('black', 12), 'red', rep('black', 9)))+
scale_x_continuous(breaks = meteo$month[seq(1,22, 2)] , labels = meteo$X[seq(1,22, 2)]) +
annotate("rect", xmin = 2, xmax = 9, ymin = -5, ymax = 420,  alpha = .8,fill = 'gray90') +
annotate("rect", xmin = 14, xmax = 21, ymin = -5, ymax = 420,  alpha = .8,fill = 'gray90') +
geom_vline(aes(xintercept=meteo$month),linetype="dotted",
size = c(rep(0.3, 12), 1, rep(0.3, 9)))+
geom_bar(stat="identity") +
annotate("rect", xmin = 4, xmax = 8, ymin = -35, ymax = -5, alpha = 1,fill = 'white') +
annotate("rect", xmin = 16, xmax = 20, ymin = -35, ymax = -5, alpha = 1,fill = 'white') +
annotate("text", x = c(6,18),y = c(-25, -25),  label = c('2015', '2016'))
meteo = read.table('monthly_meteo2015-2016.csv', sep = '\t', head = TRUE)
setwd("~/Desktop/Projet_M2/Documents/Papers/Paper1_SUM/Code and Data")
meteo = read.table('monthly_meteo2015-2016.csv', sep = '\t', head = TRUE)
meteo$month = 1:22
meteo$Season = c('Dry season', rep('Rainy season', 8), rep('Dry season',4), rep('sainy Season',8), 'Dry season')
rf = ggplot(meteo, aes(y = Rainfall, x = month))  + theme_bw()+
#  color = c(rep('black', 12), 'red', rep('black', 9)))+
labs(x = "", y = 'Rainfall (mm)') +
#scale_fill_manual(labels = c('Dry season', 'Rainy season'), values = c('gray50', 'gray10'))+
# color = c(rep('black', 12), 'red', rep('black', 9)))+
scale_x_continuous(breaks = meteo$month[seq(1,22, 2)] , labels = meteo$X[seq(1,22, 2)]) +
annotate("rect", xmin = 2, xmax = 9, ymin = -5, ymax = 420,  alpha = .8,fill = 'gray90') +
annotate("rect", xmin = 14, xmax = 21, ymin = -5, ymax = 420,  alpha = .8,fill = 'gray90') +
geom_vline(aes(xintercept=meteo$month),linetype="dotted",
size = c(rep(0.3, 12), 1, rep(0.3, 9)))+
geom_bar(stat="identity") +
annotate("rect", xmin = 4, xmax = 8, ymin = -35, ymax = -5, alpha = 1,fill = 'white') +
annotate("rect", xmin = 16, xmax = 20, ymin = -35, ymax = -5, alpha = 1,fill = 'white') +
annotate("text", x = c(6,18),y = c(-25, -25),  label = c('2015', '2016'))
rh = ggplot(meteo, aes(y = RH, x = month)) +
annotate("rect", xmin = 2, xmax = 9, ymin = 25, ymax = 100,  alpha = .8, fill = 'gray90') +
annotate("rect", xmin = 14, xmax = 21, ymin = 25, ymax = 100,  alpha = .8,fill = 'gray90') +
geom_line() +
geom_vline(aes(xintercept=meteo$month),linetype="dotted",
size = c(rep(0.3, 12), 1, rep(0.3, 9))) +
scale_x_continuous(breaks = meteo$month[seq(1,22, 2)] , labels = meteo$X[seq(1,22, 2)])  +
labs(x = "", y = 'Relative air humidity (%)') + theme_bw()
rh
rdens = ggplot(meteo, aes(y = Rdens, x = month))  +
annotate("rect", xmin = 2, xmax = 9, ymin = 0, ymax = 0.4,  alpha = .8,fill = 'gray90') +
annotate("rect", xmin = 14, xmax = 21, ymin = 0, ymax = 0.4, alpha = .8,fill = 'gray90') +
geom_vline(aes(xintercept=meteo$month),linetype="dotted",
size = c(rep(0.3, 12), 1, rep(0.3, 9)))+
scale_x_continuous(breaks = meteo$month[seq(1,22, 2)] , labels = meteo$X[seq(1,22, 2)])  +
labs(x = "", y = 'Rainfall erosivity') + theme_bw() +
geom_bar(stat="identity")
library(ggplot2)
library(grid)
library(gridExtra)
grid.arrange(rf, rh,rdens, ncol = 1)
rh = ggplot(meteo, aes(y = RH, x = month)) +
annotate("rect", xmin = 2, xmax = 9, ymin = 25, ymax = 100,  alpha = .8, fill = 'gray90') +
annotate("rect", xmin = 14, xmax = 21, ymin = 25, ymax = 100,  alpha = .8,fill = 'gray90') +
geom_line() +
geom_vline(aes(xintercept=meteo$month),linetype="dotted",
size = c(rep(0.3, 12), 1, rep(0.3, 9))) +
scale_x_continuous(breaks = meteo$month[seq(1,22, 2)] , labels = meteo$X[seq(1,22, 2)])  +
labs(x = "", y = 'Relative air humidity (%)') + theme_bw()
rh
meteo = read.table('monthly_meteo2015-2016.csv', sep = '\t', head = TRUE)
meteo$month = 1:22
meteo$Season = c('Dry season', rep('Rainy season', 8), rep('Dry season',4), rep('sainy Season',8), 'Dry season')
rf = ggplot(meteo, aes(y = Rainfall, x = month))  + theme_bw()+
#  color = c(rep('black', 12), 'red', rep('black', 9)))+
labs(x = "", y = 'Rainfall (mm)') +
#scale_fill_manual(labels = c('Dry season', 'Rainy season'), values = c('gray50', 'gray10'))+
# color = c(rep('black', 12), 'red', rep('black', 9)))+
scale_x_continuous(breaks = meteo$month[seq(1,22, 2)] , labels = meteo$X[seq(1,22, 2)]) +
annotate("rect", xmin = 2, xmax = 9, ymin = -5, ymax = 420,  alpha = .8,fill = 'gray90') +
annotate("rect", xmin = 14, xmax = 21, ymin = -5, ymax = 420,  alpha = .8,fill = 'gray90') +
geom_vline(aes(xintercept=meteo$month),linetype="dotted",
size = c(rep(0.3, 12), 1, rep(0.3, 9)))+
geom_bar(stat="identity") +
annotate("rect", xmin = 4, xmax = 8, ymin = -35, ymax = -5, alpha = 1,fill = 'white') +
annotate("rect", xmin = 16, xmax = 20, ymin = -35, ymax = -5, alpha = 1,fill = 'white') +
annotate("text", x = c(6,18),y = c(-25, -25),  label = c('2015', '2016'))
rh = ggplot(meteo, aes(y = RH, x = month)) +
annotate("rect", xmin = 2, xmax = 9, ymin = 25, ymax = 100,  alpha = .8, fill = 'gray90') +
annotate("rect", xmin = 14, xmax = 21, ymin = 25, ymax = 100,  alpha = .8,fill = 'gray90') +
geom_line() +
geom_vline(aes(xintercept=meteo$month),linetype="dotted",
size = c(rep(0.3, 12), 1, rep(0.3, 9))) +
scale_x_continuous(breaks = meteo$month[seq(1,22, 2)] , labels = meteo$X[seq(1,22, 2)])  +
labs(x = "", y = 'Relative air humidity (%)') + theme_bw()
rh
rdens = ggplot(meteo, aes(y = Rdens, x = month))  +
annotate("rect", xmin = 2, xmax = 9, ymin = 0, ymax = 0.4,  alpha = .8,fill = 'gray90') +
annotate("rect", xmin = 14, xmax = 21, ymin = 0, ymax = 0.4, alpha = .8,fill = 'gray90') +
geom_vline(aes(xintercept=meteo$month),linetype="dotted",
size = c(rep(0.3, 12), 1, rep(0.3, 9)))+
scale_x_continuous(breaks = meteo$month[seq(1,22, 2)] , labels = meteo$X[seq(1,22, 2)])  +
labs(x = "", y = 'Rainfall erosivity') + theme_bw() +
geom_bar(stat="identity")
library(ggplot2)
library(grid)
grid.arrange(rf, rh, rdens, ncol = 1)
library(gridExtra)
rdens = ggplot(meteo, aes(y = Rdens, x = month))  +
annotate("rect", xmin = 2, xmax = 9, ymin = 0, ymax = 0.4,  alpha = .8,fill = 'gray90') +
annotate("rect", xmin = 14, xmax = 21, ymin = 0, ymax = 0.4, alpha = .8,fill = 'gray90') +
geom_vline(aes(xintercept=meteo$month),linetype="dotted",
size = c(rep(0.3, 12), 1, rep(0.3, 9)))+
scale_x_continuous(breaks = meteo$month[seq(1,22, 2)] , labels = meteo$X[seq(1,22, 2)])  +
labs(x = "", y = 'Rainfall erosivity') + theme_bw() +
geom_bar(stat="identity")
grid.arrange(rf, rh, rdens, ncol = 1)
meteo = read.table('monthly_meteo2015-2016.csv', sep = '\t', head = TRUE)
meteo$month = 1:22
meteo$Season = c('Dry season', rep('Rainy season', 8), rep('Dry season',4), rep('sainy Season',8), 'Dry season')
rf = ggplot(meteo, aes(y = Rainfall, x = month))  + theme_bw()+
#  color = c(rep('black', 12), 'red', rep('black', 9)))+
labs(x = "", y = 'Rainfall (mm)') +
#scale_fill_manual(labels = c('Dry season', 'Rainy season'), values = c('gray50', 'gray10'))+
# color = c(rep('black', 12), 'red', rep('black', 9)))+
scale_x_continuous(breaks = meteo$month[seq(1,22, 2)] , labels = meteo$X[seq(1,22, 2)]) +
annotate("rect", xmin = 2, xmax = 9, ymin = -5, ymax = 420,  alpha = .8,fill = 'gray90') +
annotate("rect", xmin = 14, xmax = 21, ymin = -5, ymax = 420,  alpha = .8,fill = 'gray90') +
geom_vline(aes(xintercept=meteo$month),linetype="dotted",
size = c(rep(0.3, 12), 1, rep(0.3, 9)))+
geom_bar(stat="identity") +
annotate("rect", xmin = 4, xmax = 8, ymin = -35, ymax = -5, alpha = 1,fill = 'white') +
annotate("rect", xmin = 16, xmax = 20, ymin = -35, ymax = -5, alpha = 1,fill = 'white') +
annotate("text", x = c(6,18),y = c(-25, -25),  label = c('2015', '2016'))
rh = ggplot(meteo, aes(y = RH, x = month)) +
annotate("rect", xmin = 2, xmax = 9, ymin = 25, ymax = 100,  alpha = .8, fill = 'gray90') +
annotate("rect", xmin = 14, xmax = 21, ymin = 25, ymax = 100,  alpha = .8,fill = 'gray90') +
geom_line() +
geom_vline(aes(xintercept=meteo$month),linetype="dotted",
size = c(rep(0.3, 12), 1, rep(0.3, 9))) +
scale_x_continuous(breaks = meteo$month[seq(1,22, 2)] , labels = meteo$X[seq(1,22, 2)])  +
labs(x = "", y = 'Relative air humidity (%)') + theme_bw()
rh
rdens = ggplot(meteo, aes(y = Rdens, x = month))  +
annotate("rect", xmin = 2, xmax = 9, ymin = 0, ymax = 0.4,  alpha = .8,fill = 'gray90') +
annotate("rect", xmin = 14, xmax = 21, ymin = 0, ymax = 0.4, alpha = .8,fill = 'gray90') +
geom_vline(aes(xintercept=meteo$month),linetype="dotted",
size = c(rep(0.3, 12), 1, rep(0.3, 9)))+
scale_x_continuous(breaks = meteo$month[seq(1,22, 2)] , labels = meteo$X[seq(1,22, 2)])  +
labs(x = "", y = 'Rainfall erosivity') + theme_bw() +
geom_bar(stat="identity")
library(ggplot2)
library(grid)
library(gridExtra)
grid.arrange(rf, rh, rdens, ncol = 1)
meteo = read.table('monthly_meteo2015-2016.csv', sep = '\t', head = TRUE)
meteo$month = 1:22
meteo$Season = c('Dry season', rep('Rainy season', 8), rep('Dry season',4), rep('sainy Season',8), 'Dry season')
rf = ggplot(meteo, aes(y = Rainfall, x = month))  + theme_bw()+
#  color = c(rep('black', 12), 'red', rep('black', 9)))+
labs(x = "", y = 'Rainfall (mm)') +
#scale_fill_manual(labels = c('Dry season', 'Rainy season'), values = c('gray50', 'gray10'))+
# color = c(rep('black', 12), 'red', rep('black', 9)))+
scale_x_continuous(breaks = meteo$month[seq(1,22, 2)] , labels = meteo$X[seq(1,22, 2)]) +
annotate("rect", xmin = 2, xmax = 9, ymin = -5, ymax = 420,  alpha = .8,fill = 'gray90') +
annotate("rect", xmin = 14, xmax = 21, ymin = -5, ymax = 420,  alpha = .8,fill = 'gray90') +
geom_vline(aes(xintercept=meteo$month),linetype="dotted",
size = c(rep(0.3, 12), 1, rep(0.3, 9)))+
geom_bar(stat="identity") +
annotate("rect", xmin = 4, xmax = 8, ymin = -35, ymax = -5, alpha = 1,fill = 'white') +
annotate("rect", xmin = 16, xmax = 20, ymin = -35, ymax = -5, alpha = 1,fill = 'white') +
annotate("text", x = c(6,18),y = c(-25, -25),  label = c('2015', '2016'))
rh = ggplot(meteo, aes(y = RH, x = month)) +
annotate("rect", xmin = 2, xmax = 9, ymin = 25, ymax = 100,  alpha = .8, fill = 'gray90') +
annotate("rect", xmin = 14, xmax = 21, ymin = 25, ymax = 100,  alpha = .8,fill = 'gray90') +
geom_line() +
geom_vline(aes(xintercept=meteo$month),linetype="dotted",
size = c(rep(0.3, 12), 1, rep(0.3, 9))) +
scale_x_continuous(breaks = meteo$month[seq(1,22, 2)] , labels = meteo$X[seq(1,22, 2)])  +
labs(x = "", y = 'Relative air humidity (%)') + theme_bw()
rh
rdens = ggplot(meteo, aes(y = Rdens, x = month))  +
annotate("rect", xmin = 2, xmax = 9, ymin = 0, ymax = 0.4,  alpha = .8,fill = 'gray90') +
annotate("rect", xmin = 14, xmax = 21, ymin = 0, ymax = 0.4, alpha = .8,fill = 'gray90') +
geom_vline(aes(xintercept=meteo$month),linetype="dotted",
size = c(rep(0.3, 12), 1, rep(0.3, 9)))+
scale_x_continuous(breaks = meteo$month[seq(1,22, 2)] , labels = meteo$X[seq(1,22, 2)])  +
labs(x = "", y = 'Rainfall erosivity') + theme_bw() +
geom_bar(stat="identity")
grid.arrange(rf, rh, rdens, ncol = 1)
pdf('/Users/Margot/Desktop/Projet_M2/Documents/Papers/Paper1SUM/Figures/meteo.pdf', width = 9, height = )
pdf('/Users/Margot/Desktop/Projet_M2/Documents/Papers/Paper1_SUM/Figures/meteo.pdf', width = 9, height = )
grid.arrange(rf, rh, rdens, ncol = 1)
dev.off()
